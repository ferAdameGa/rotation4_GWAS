# Step by step guide

## Input files

### 0. Make sure IDs on VCF and excel files with phenotypes match
- Change names
```ruby
file = open("id_vcf.txt", "r")
vcf_id=file.readlines()
file.close()

ids=[]
for name in vcf_id:    
    splited=name.split("Am_")
    final=splited[1].split("_")
    ids.append(final[1])
    

with open('replace_id.txt','w') as tfile:
	tfile.write('\n'.join(ids))
```
- Filter IDs
```ruby
module load bcftools

file=$(ls ${dir}*.vcf.gz | sed -n ${SLURM_ARRAY_TASK_ID}p)
base=$(basename $file ".vcf.gz")
echo ${base}

bcftools view -S IDs.txt ${base}.vcf.gz > filtered_vcf/filt_chr${SLURM_ARRAY_TASK_ID}.vcf
```
[More info](01Gemma_intro.md)

### 1. Join all chromosome VCF files 
```ruby
ls *.vcf > files.txt

module load bcftools

bcftools concat -f files.txt -o merged.vcf
```
### 2. Add phenotype information and convert plink file
```ruby
module load plink

vcf="/nfs/scistore17/robingrp/madamega/rotation4/VCF_files/filtered_vcf/merged.vcf"

plink2 --vcf ${vcf} --make-bed --pheno phenotype_id.txt --pheno-col-nums 4 --out pheno/merged/plink_yellow
plink2 --vcf ${vcf} --make-bed --pheno phenotype_id.txt --pheno-col-nums 5 --out pheno/merged/plink_venation
plink2 --vcf ${vcf} --make-bed --pheno phenotype_id.txt --pheno-col-nums 6 --out pheno/merged/plink_class
```
